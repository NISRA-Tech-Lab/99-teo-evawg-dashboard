---
title: "recorded-crime"
---



```{r}
#| include: FALSE

library(here)
source(paste0(here(), "/data_prep/recordedcrime_data_prep.R"))
```

## Row

### Column {width=50%}

```{r}
#| title: Police recorded crime by offence
#| fig-height: 10


# Prepare ticks for category years like "2024/25"
years <- as.character(police_recorded_crime_historical_chart1$Year)
tick_every_5 <- years[seq(1, length(years), by = 5)]

plot_ly(police_recorded_crime_historical_chart1, x = ~Year) %>%
  add_trace(
    y = ~`Violence Against the Person (excluding stalking and harassment)`,
    name = "Violence Against the Person<br>(excluding stalking<br>and harassment)",  # Legend label with break
    text = ~paste(
      Year,
      paste0(
        "Violence Against the Person<br>(excluding stalking and harassment): ",
        format(`Violence Against the Person (excluding stalking and harassment)`, big.mark = ",")
      ),
      sep = "<br>"
    ),
    hoverinfo = "text",
    type = "scatter", mode = "lines+markers",
    line = list(color = nisra_colours[2]),
    marker = list(color = nisra_colours[2])
  ) %>%
  add_trace(
    y = ~`Stalking and Harassment`,
    name = "Stalking and Harassment",
    text = ~paste(
      Year,
      paste0(
        "Stalking and Harassment: ",
        format(`Stalking and Harassment`, big.mark = ",")
      ),
      sep = "<br>"
    ),
    hoverinfo = "text",
    type = "scatter", mode = "lines+markers",
    line = list(color = nisra_colours[1]),
    marker = list(color = nisra_colours[1])
  ) %>%
  add_trace(
    y = ~Sexual,
    name = "Sexual",
    text = ~paste(
      Year,
      paste0(
        "Sexual: ",
        format(Sexual, big.mark = ",")
      ),
      sep = "<br>"
    ),
    hoverinfo = "text",
    type = "scatter", mode = "lines+markers",
    line = list(color = nisra_colours[3]),
    marker = list(color = nisra_colours[3])
  ) %>%
  layout(
    margin = list(t = 50),
    xaxis = list(
      type = "category",
      categoryorder = "array",
      categoryarray = years,
      tickmode = "array",
      tickvals = tick_every_5,
      ticktext = tick_every_5,
      tickangle = 0,
      showline = TRUE,
      linecolor = "black",
      linewidth = 1,
      showgrid = FALSE,
      zeroline = FALSE
    ),
    yaxis = list(
      title = list(text = ""),
      rangemode = "tozero",
      showgrid = FALSE,
      showline = TRUE,
      linecolor = "black",
      linewidth = 1,
      zeroline = FALSE,
      tickformat = ",d"   # full comma-separated format
    ),
    annotations = list(
      list(
        x = 0.00, xref = "paper", xanchor = "center",
        y = 1.025, yref = "paper", yanchor = "bottom",
        text = "Number of<br>crimes",
        showarrow = FALSE,
        font = list(size = 14)
      )
    )
  ) %>%
  config(displayModeBar = FALSE)
```


### Column {width=50%}

```{r}

```

