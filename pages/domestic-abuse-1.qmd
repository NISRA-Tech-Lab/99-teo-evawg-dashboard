---
title: "domestic-abuse-1"

---



```{r}
#| include: FALSE

library(here)
source(paste0(here(), "/data_prep/domabuse_data_prep.R"))
```

## Row

### Column {width=100%}


```{r}

# Calculate dynamic y-axis range from both Incidents and Crimes
y_min <- floor(min(c(combined_data$Incidents, combined_data$Crimes)) / 1000) * 1000
y_max <- ceiling(max(c(combined_data$Incidents, combined_data$Crimes)) / 1000) * 1000
tick_vals <- seq(y_min, y_max, by = 1000)

fig_1 <- plot_ly(
  combined_data,
  x = ~Year,
  y = ~Incidents,
  type = 'scatter',
  mode = 'lines+markers',
  name = "Incidents",
  line = list(color = 'nisra_blue'),
  hoverinfo = 'text',
  text = ~paste0("Incidents - ", Year, ": ", round(Incidents / 1000, 1))
) %>%
  add_trace(
    y = ~Crimes,
    mode = 'lines+markers',
    name = "Crimes",
    line = list(color = 'nisra_col3_green'),
    text = ~paste0("Crimes - ", Year, ": ", round(Crimes / 1000, 1)),
    hoverinfo = 'text'
  ) %>%
  layout(
    showlegend = TRUE,
    font = list(family = "Arial", size = 14),
    margin = list(b = 150),
    xaxis = list(
      title = list(text = "Year", standoff = 10),
      showline = TRUE,
      linecolor = "#000000",
      showgrid = FALSE,
      ticks = "outside",
      tickwidth = 2,
      tickangle = 0,
      dtick = 2,
      automargin = TRUE
    ),
    yaxis = list(
      title = "",
      showline = TRUE,
      linecolor = "#000000",
      showgrid = FALSE,
      range = c(y_min, y_max),
      tickvals = tick_vals,
      ticktext = format(tick_vals / 1000, nsmall = 1)
    ),
    annotations = list(
      list(
        x = 0.09, y = 1.03,
        text = "Incidents and Crimes (Thousands)",
        showarrow = FALSE,
        xref = "paper", yref = "paper",
        xanchor = "center", yanchor = "middle",
        font = list(size = 14, color = "black")
      )
    )
  ) %>%
  config(displayModeBar = FALSE)

fig_1


```


### Column {width=100%}

```{r echo = FALSE, fig.show='hold'}
```


